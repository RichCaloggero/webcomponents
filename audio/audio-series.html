<!--<link rel="import" href="../polymer/lib/elements/dom-if.html">-->
<!--<link rel="import" href="../polymer/lib/elements/dom-repeat.html">-->

<dom-module id="audio-series">
<template>
<style>
:host {
display: block;
}
</style>

<div class="audio-series">
</div>

</template>

<script>
"use strict";

class AudioSeries extends _AudioContext_ {
static get is() { return "audio-series"; }

constructor () {
super ();
this.in = null;
this.out = null;
} // constructor

connectedCallback () {
var children = Array.from(this.childNodes).filter ((node) => node.nodeType === 1);
var loaded = children.map ((element) => {
//alert ("element: " + element);
customElements.whenDefined (element.localName);
});

Promise.all (loaded).then (() => {
//alert (`all ${loaded.length} elements loaded`);
this.connectAll (children);
}).catch (function (error) {
alert (error);
throw error;
});
} // connectedCallback

connectAll (nodes) {
alert (`connecting all ${nodes.length} nodes`);

for (var i=0; i<nodes.length-1; i++) {
let e1 = nodes[i], e2 = nodes[i+1], n1 = e1.audioNode, n2 = e2.audioNode;
alert (`connecting ${e1.is}:${n1} to ${e2.is}:${n2}`);
n1.connect (n2);
} // for
} // connectAll

} // class AudioSeries

window.customElements.define(AudioSeries.is, AudioSeries);
</script>
</dom-module>
